# 精通比特币

## 作者： Andreas M Antonopoulos

## 专有名词：

- 地址

  >比特币地址（例如：1DSrfJdB2AnWaFNgSbv3MZC2m74996JafV）由一串字符和数字组成，以阿拉伯数字“1”开头。就像别人向你的email地址发送电子邮件一样，他可以通过你的比特币地址向你发送比特币。

- BIP

  >比特币改进提议 （Bitcoin Improvement Proposals 的缩写），指比特币社区成员所提交的一系列改进比特币的提议。例如，BIP0021是一项改进比特币统一资源标识符（URI）计划的提议。

- 比特币

  >“比特币”既可以指这种虚拟货币单位，也指比特币网络或者网络节点使用的比特币软件。

- 区块

  >一个区块就是若干交易数据的集合，它会被标记上时间戳和之前一个区块的独特标记。区块头经过哈希运算后会生成一份工作量证明，从而验证区块中的交易。有效的区块经过全网络的共识后会被追加到主区块链中。

- 区块链

  >区块链是一串通过验证的区块，当中的每一个区块都与上一个相连，一直连到创世区块。

- 确认

  > 当一项交易被区块收录时，我们可以说它有一次确认。矿工们在此区块之后每再产生一个区块，此项交易的确认数就再加一。当确认数达到六及以上时，通常认为这笔交易比较安全并难以逆转。

- 难度

  > 整个网络会通过调整“难度”这个变量来控制生成工作量证明所需要的计算力。

- 难度目标

  >使整个网络的计算力大致每10分钟产生一个区块所需要的难度数值即为难度目标。

- 难度调整

  >整个网络每产生2,106个区块后会根据之前2,106个区块的算力进行难度调整。

- 矿工费

  > 交易的发起者通常会向网络缴纳一笔矿工费，用以处理这笔交易。大多数的交易需要0.5毫比特币的矿工费。

- 哈希

  > 二进制数据的一种数字指纹。

- 创世区块

  > 创世区块指区块链上的第一个区块，用来初始化相应的加密货币。

- 矿工

  > 矿工指通过不断重复哈希运算来产生工作量证明的各网络节点.

- 网络

  > 比特币网络是一个由若干节点组成的用以广播交易信息和数据区块的P2P网络。

- 工作量证明

  > 工作量证明指通过有效计算得到的一小块数据。具体到比特币，矿工必须要在满足全网目标难度的情况下求解SHA256算法。

- 奖励

  > 每一个新区块中都有一定量新创造的比特币用来奖励算出工作量证明的矿工。现阶段每一区块有25比特币的奖励。

- 私钥

  > 用来解锁对应（钱包）地址的一串字符，例如5J76sF8L5jTtzE96r66Sf8cka9y44wdpJjMwCxR3tzLh3ibVPxh。

- 交易

  > 简单地说，交易指把比特币从一个地址转到另一个地址。更准确地说，一笔“交易”指一个经过签名运算的，表达价值转移的数据结构。每一笔“交易”都经过比特币网络传输，由矿工节点收集并封包至区块中，永久保存在区块链某处。

- 钱包

  > 钱包指保存比特币地址和私钥的软件，可以用它来接受、发送、储存你的比特币。

# 第一章 介绍

## 1.1 什么是比特币

> 比特币是由一系列概念和技术作为基础构建的数字货币生态系统。狭义的”比特币“代表系统中的货币单位，用于存储和传输价值。

用户只要有证明其控制权的密钥，用密钥解锁，就可以发送比特币。这些密钥通常存储在计算机的数字钱包里。拥有密钥是使用比特币的唯一条件，控制权掌握在每个人手上。

比特币是一个分布式的点对点网络系统。因此没有”中央“服务器，也没有中央发行机构。比特币是通过”挖矿“产生的，挖矿就是验证比特币交易的同时参与竞赛来解决一个数学问题。

**比特币系统包含调节挖矿难度的协议。 挖矿---在比特币网络中成果写入一个区块交易 ----的难度是动态调整的， 保证不管有多少矿工（多少CPU）挖矿，平均每10分钟只有一个矿工成功**

比特币协议还规定，每四年新币的开采量减半，同时限制比特币的最终开采量为**2100万枚**。这样，流通的比特币数量非常接近一条曲线，并将在2140年比特币达到 **2100万枚**。 由于比特币的开采速度随时间递减，从长期来看，比特币是一种通货紧缩货币。此外，不能通过“”印刷“新比特币来实现”通货膨胀“。

- 一个去中心化的点对点网络（比特币协议）
- 一个公共的交易账簿（区块链）
- 一个去中心化的数字和确定性的货币发行（分布式挖矿）
- 一个去中心化的交易验证系统（交易脚本）

## 1.2 比特币发展史

比特币系统依赖于完全透明的数学原理，这项发明本身就是开创性的，它应蔓延到了分布式计算，经济学，计量经济学领域。

**一个分布式计算问题的解决方案**

中本聪的此项发明，对“拜占庭将军”问题也是一个可行的解决方案，这是一个在分布式计算中未曾解决的问题。简单来说，这个问题包括了试图通过这个不可靠，具有潜在威胁的网络中，通过信息交流来达成一个行动协议共识。 中本聪的解决是使用了工作量证明的概念在没有中央信任机构下达成共识，这代表了分布式计算的科学突破，并已经超越了货币广泛性的适用性。它可以用来达成去中心化的网络共识来公正选举，彩票，财产登记，以及数字化公证等等。

# 第二章 比特币的原理

## 2.1 交易，区块，挖矿和区块链

![img](https://book.8btc.com/books/1/master_bitcoin/_book/2/2-1.png)

比特币交易

比特币交易是将钱从交易输入移至输出。输入的指钱币的来源，通常是之前一笔交易的输出。交易的输出则是通过关联一个密钥的方式将钱赋予一个新的所有者。目的密钥被称为安全锁（Encumbrance）。这样就给资金强加了一个要求：有签名才能在以后的交易中赎回资金。

一笔交易的输出当作另一种新交易的输入，这样随着钱从一个地址被移动到另一个地址的同时形成了一条所有权链

![img](https://book.8btc.com/books/1/master_bitcoin/_book/2/2-4.png)

### 常见的交易形式

![img](https://book.8btc.com/books/1/master_bitcoin/_book/2/2-5.png)

 一般交易： 有一个输入和两个输出

![img](https://book.8btc.com/books/1/master_bitcoin/_book/2/2-6.png)

集合型交易：多个输入到一个输出的模式。这个相当于现实生活中很多硬币和纸币零钱兑换为一个大额面钞。像这样的交易有时由钱包应用产生来清理许多在支付过程收到的小数额的找零。

![img](https://book.8btc.com/books/1/master_bitcoin/_book/2/2-7.png)

分散型交易：在比特币账簿中常见的交易形式是将一个输入分配给多个输出，即多个接收者的交易。这类交易有时被商业实体用作分配资金， 例如多个雇员发工资的情形。

**交易的传送**

比特币网络的目的就是将交易和区块传播给所有参与者

**如何传播**

钱包将新的交易给其他任意一个联接到互联网的比特币客户端。任何比特币网络节点（其他客户端）收到一个之前没有见过的有效交易时会立即将它转发给联结到自身的其他节点。因此，这个交易迅速从P2P网络中传播开来，几秒内就能到达大多数节点。

**商家变动**

如果商家应用直接链接的是Alice的钱包应用的话，Bod的钱包应用也许就是第一个收到这个交易的节点。如果是从其他节点发送过来，一样可以在几秒钟内到达商家钱包应用这里。商家的钱包会立即确认 客户的交易是一个收入支付， 因为它包含能用客户的私钥兑换的输出。 客户的钱包应用也能够独立地用之前未消费输入来确认这个交易是正确构建的，并且由于包含足够交易费会被下一个区块包含进去。这时客户就可以以一个很小的风险假定这个交易会被加到区块且被确认。

````
一个对比特币交易的常见误解是它们必须要等10分钟后被确认加进一个新区块，或等60分钟以得到六次确认后才是有效的。虽然这些确认可以确保交易已被整个网络接受，但对于像一杯咖啡这样的小额商品来说就没有必要等待那么长时间了。一个商家可以免确认来接受比特币小额支付。这样做的风险不比接受一个不是用有效身份证领取或没有签名的信用卡的风险更大，而后者是现在商家常做的事情。
````

## 2.4 比特币挖矿

这个交易现在在比特币网络上传播开来。但只有被一个称为挖矿的过程验证且加到一个区块中之后，这个交易才会成为这个共享账簿（区块链）的一部分。

比特币系统的信任是建立在计算的基础上的。交易被包在一起放进区块中时需要极大的计算量来证明，但只需要少量计算就能验证它们已被证明。

挖矿在比特币中起着两个作用：

- 挖矿在构建区块时会创造新的比特币，和一个中央银行引发的纸币很类似。每一区块创造的比特币数量时固定的，随时间会渐渐减少。
- 挖矿创建信任。挖矿确保只有在包含交易的区块上贡献了足够的计算量后，这些交易才被确认。区块越多，花费的计算量越大，意味着更多的信任。

## 2.5 区块中的挖矿记录

网络中产生的一笔交易直到成为真个比特币大账簿------ 区块链的一部分时才会被确认有效。平均10分钟，矿工会将自上一个区块以来发生的所有交易生成一个新的区块。新的交易不断地从用户钱包和应用流入比特币网络中。当比特币网络上的节点看到这些交易时，会先将它们放到各自节点维护的一个临时的未经验证的交易池中。当矿工构建一个新区块时，会将这些交易从这个交易池中拿出来放到这个新区块中，然后通过尝试解决一个非常困难的问题（也叫工作量证明）以证明这个新区块的合法性。

这些交易被加进 新区块时， 以交易费用高的优先以及其它的一些规则进行排序。

![img](https://book.8btc.com/books/1/master_bitcoin/_book/2/2-9.png)

## 2.6 消费这笔交易

![img](https://book.8btc.com/books/1/master_bitcoin/_book/2/2-10.png)

